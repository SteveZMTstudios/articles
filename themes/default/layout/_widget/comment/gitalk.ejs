<script>
  if (!window.GITALK_SRC) {
    window.GITALK_SRC = '<%= theme.comment.gitalk_js || "//gcore.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" %>';
  }
</script>
<div id="gitalk-container"></div>
<link rel="stylesheet" href="//gcore.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script data-pjax src="//stevezmt.top/sharepoint/js/3rd-party/gitalk-cn.min.js"></script>
<script>
  function __normalizeGitalkId(raw) {
    try {
      if (!raw) raw = location.pathname;

      if (/^https?:\/\//i.test(raw)) {
        var u = new URL(raw, window.location.origin);
        raw = u.pathname || '/';
      }

      try { raw = decodeURI(raw); } catch (e) {}

      var looksLikePath = /\//.test(raw) || /\.html?$/i.test(raw);
      if (looksLikePath) {

        raw = raw.replace(/index\.html$/i, '');

        if (raw && raw.charAt(0) !== '/') raw = '/' + raw;

        if (raw.length > 1 && raw.endsWith('/')) raw = raw.slice(0, -1);
        return raw || '/';
      }

      return String(raw);
    } catch (e) {
      return (window.location && window.location.pathname) || '/';
    }
  }

  window.GITALK_CONFIG = {
    clientID: '<%= theme.comment.gitalk_client_id %>',
    clientSecret: '<%= theme.comment.gitalk_client_secret %>',
    repo: '<%= theme.comment.gitalk_repo %>',
    owner: '<%= theme.comment.gitalk_owner %>',
    admin: ['<%= theme.comment.gitalk_owner %>'],

    id: (function() {
      var preset = '<%= page[theme.comment.gitalk_sid_type] %>';
      if (!preset || preset === 'undefined' || preset === 'null') preset = '';
      return __normalizeGitalkId(preset || (window.location && window.location.pathname));
    })(),
    distractionFreeMode: false
  };

</script>
